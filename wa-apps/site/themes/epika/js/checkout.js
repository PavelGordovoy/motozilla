$(function(){function a(a){var b=$(".checkout").attr("data-url");$.get(b+a+"/",function(b){var c=$(".checkout-step .checkout-step-content:visible"),d=c.find(".checkout-content").data("step-id");d!=a&&c.parent().find("a.back").hide(),$(".checkout-step.step-"+a+" .checkout-content").replaceWith(b),$(".checkout-step.step-"+a+" a.back").show(),$(".checkout-step.step-"+a+" h2").removeClass("upcoming"),$(".checkout-step.step-"+a).next(".checkout-step").each(function(){$(this).find("h2").addClass("upcoming")}),$(".checkout-step.step-"+a).prev(".checkout-step").each(function(){$(this).find("h2").removeClass("upcoming")}),d!=a&&$(".checkout-step.step-"+a+" .checkout-step-content").show(0).css({height:"auto"}),$(".checkout-step.step-"+a+" .auth").length&&$("input[name='user_type']").change()})}function b(a){var b=$(a),c=b.find(".checkout-content").data("step-id");if("payment"==c||"shipping"==c){if(!b.find('input[name="'+c+'_id"]:checked').not(":disabled").length)return b.find("em.errormsg").length||$('<em class="errormsg inline">'+("payment"==c?"[`Please select payment option`]":"[`Please select shipping option`]")+"</em>").insertAfter(b.find("input:submit:last")),!1;b.find("em.errormsg").remove()}return b.hasClass("last")||$("#login-form").length&&$(".checkout-login-user").hasClass("active")?($('<span class="loading"> <i class="icon24 loading"></i></span>').insertBefore(b.find("input:submit:last")),$.cookie("epika_shop_incart",null,{expires:30,path:"/"}),!0):($('<span class="loading"> <i class="icon24 loading"></i></span>').insertAfter(b.find("input:submit:last").attr("disabled","disabled")),$.post(b.attr("action")||window.location,b.serialize(),function(b){var e=$(b);if("confirmation"==c)return $("#page-content .checkout").hide().html(e).fadeIn(),window.history.pushState({},"",_wa_url+"/checkout/success/"),!1;var f=e.data("step-id");f||(f=e.filter(".checkout-content").data("step-id"));var g=$(".checkout-step .checkout-step-content:visible"),h=g.find(".checkout-content").data("step-id");h!=f&&(g.parent().find("a.back").hide(),d(f)),e.hide(),$(".checkout-step.step-"+f+" .checkout-content").replaceWith(e),e.fadeIn(),$(".checkout-step.step-"+f+" input[type=submit]:last").show(),h!=f&&$(".checkout-step.step-"+f+" .checkout-step-content").show(0).css({height:"auto"}),$(".checkout-step.step-"+f+" h2").removeClass("upcoming"),$(".checkout-step.step-"+f).next(".checkout-step").each(function(){$(a).find("h2").addClass("upcoming")}),$(".checkout-step.step-"+f).prev(".checkout-step").each(function(){$(a).find("h2").removeClass("upcoming")}),$('[data-toggle="tooltip"]').tooltip()}).always(function(){b.find("span.loading").remove(),b.find("input:submit:last").removeAttr("disabled")}),!1)}function d(a){if(!($(".checkout ul.steps li").length<=0)){var b=c.find("li.c-a-step");if(b.length<=0&&(b=$(".checkout ul.steps li").eq(0),b.addClass("c-a-step")),b.index()<parseInt($(".checkout ul.steps li").length)-1){var d=$(b).next();if(d.length>0){d.addClass("current").addClass("c-a-step"),e(a),b.addClass("checked"),b.removeClass("current").removeClass("c-a-step"),b.find("strong").addClass("animated").addClass("zoomOut").hide(),setTimeout(function(){b.find("i").show().addClass("animated").addClass("zoomIn")},200);var f=$(".tab-content div.active");f.removeClass("active"),f.next().addClass("active")}}}}function e(a){"confirmation"==a?($(".ep-cart-mini").addClass("animated").addClass("zoomOut"),setTimeout(function(){$(".ep-cart-mini").hide()},100),$(".tab-content").addClass("animated").addClass("fadeInUp").addClass("ep-chekout-full")):($(".ep-cart-mini").removeClass("animated").removeClass("zoomOut").fadeIn(),$(".tab-content").removeClass("animated").removeClass("fadeInUp").removeClass("ep-chekout-full"))}$("header .banner h3").text("[`Checkout`]"),$("header .banner h3").show(),$("form.checkout-form").on("submit",function(){return b(this)});var c=$(".checkout ul.steps");c.on("click",".number",function(b){var c=$(this).closest("li");if(!c.hasClass("c-a-step")&&(c.hasClass("checked")||c.hasClass("current"))){$(".checkout ul.steps li").removeClass("c-a-step"),c.addClass("c-a-step");var d=c.index();$(".tab-content div.tab-pane").removeClass("active");var f=$(".tab-content div.tab-pane").eq(d);f.hide(),f.addClass("active"),f.fadeIn();var g=f.find(".checkout-content").data("step-id");e(g),a(g)}}),$(document).on("click",".checkout-step-content ul li label",function(a){$(".checkout-step-content li label").removeClass("active"),$(this).closest("li label").addClass("active"),$(".checkout-step-content li").removeClass("active"),$(this).closest("li").addClass("active")}),$(document).on("click","#tabstep_contactinfo .forgotpass-form a",function(a){if("/login/"==$(this).attr("href"))return a.preventDefault(),a.stopPropagation(),$("#tabstep_contactinfo .forgotpass-form").fadeOut("normal",function(){$(this).html(""),$("#tabstep_contactinfo #login-form .login").fadeIn("fast")}),!1}),$(".ep-cart-mini").html('<div class="loader"> </div>'),$.get(_wa_url+"cart/",{type:"checkoutcart"},function(a){$(".ep-cart-mini").html(a)})});